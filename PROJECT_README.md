# QA ImageProcess - 图像质检管理系统

## 项目概述

**QA ImageProcess** 是一个基于Flutter开发的图像质检管理系统，专为图像数据的采集、处理、质检和管理工作流程而设计。该系统采用前后端分离架构，Flutter作为跨平台客户端，主要支持Windows桌面应用环境。

### 主要特性

- 🔐 **多角色权限管理** - 支持管理员和普通用户两种角色
- 📋 **完整工作流程** - 从任务创建到质检交付的全流程管理
- 🖼️ **图像处理能力** - 支持图像预览、AI生成问题等功能
- 🔍 **智能质检系统** - 支持人工质检和AI辅助质检
- 💻 **桌面应用优化** - 针对Windows桌面环境优化的用户体验
- ⚙️ **灵活配置管理** - 支持系统设置的本地持久化存储

## 功能模块

### 1. 用户认证与权限管理

#### 登录注册系统
- 邮箱密码登录验证（未使用邮箱验证，只要是邮箱格式即可）
- 用户注册和账户激活
- Token-based身份认证
- 自动登录状态保持

#### 角色权限控制
- **管理员 (role=1)**：拥有所有系统权限
  - 用户管理
  - 任务创建和分配
  - 系统设置
  - 数据统计查看
- **普通用户 (role=0)**：基础操作权限
  - 查看分配的任务
  - 执行质检工作
  - 个人信息管理

### 2. 工作任务管理

#### 任务生命周期
系统支持8种任务状态的完整流转：

```
未采集 → 正在采集 → 采集完成 → 等待质检 → 正在质检 → 质检打回/质检通过 → 等待交付 → 交付完成
```

#### 任务管理功能
- **任务创建**：管理员可创建新的图像处理任务
- **任务分配**：将任务分配给指定的工作人员
- **进度跟踪**：实时查看任务执行进度和状态
- **任务统计**：提供详细的任务数据统计和报表

### 3. 图像质检系统

#### 质检工作台
- **任务队列管理**：显示待质检、进行中、已完成的任务
- **图像查看器**：支持图像缩放、旋转、标注等操作
- **质检表单**：结构化的质检问题和答案记录
- **质检结果**：支持通过、打回、备注等操作

#### 质检流程
- **自动分配**：系统自动将完成采集的任务分配给质检员
- **质检标准**：支持自定义质检标准和评分规则
- **结果反馈**：质检结果实时反馈给相关人员

### 4. 系统管理

#### 用户管理（管理员功能）
- **用户列表**：查看和管理所有系统用户
- **角色分配**：修改用户角色和权限
- **批量操作**：支持批量用户操作
- **用户状态管理**：激活、禁用用户账户

#### 系统设置
- **服务器配置**：后端API服务器地址设置
- **AI服务集成**：配置外部AI服务API
- **文件存储**：配置文件上传和存储路径
- **系统参数**：其他系统运行参数配置

## 技术架构

### 前端技术栈

- **Flutter 3.8.1+** - 跨平台UI框架
- **Dart** - 编程语言

### 核心依赖包

```yaml
dependencies:
  flutter: sdk: flutter
  cupertino_icons: ^1.0.8
  shared_preferences: ^2.5.3    
  window_manager: ^0.5.1        # 桌面窗口管理
  http: ^1.4.0                  # HTTP请求
  dio: ^5.8.0+1                 # 高级HTTP客户端
  file_picker: ^10.2.1          # 文件选择器
  image: ^4.5.4                 # 图像处理
  flutter_image_compress: ^2.4.0 # 图像压缩
  universal_html: ^2.2.4        # HTML支持
  mime: ^2.0.0                  # MIME类型处理
  collection: ^1.19.1           # 集合工具
```

### 项目结构

```
lib/
├── UserAccount/              # 用户认证模块
│   ├── login_page.dart       # 登录页面
│   └── register_page.dart    # 注册页面
├── MyWidget/                 # 自定义UI组件
│   ├── diffuse_gradient_background.dart
│   └── image_detail.dart
├── model/                    # 数据模型层
│   ├── user.dart            # 用户模型
│   ├── work_model.dart      # 工作任务模型
│   ├── image_model.dart     # 图像数据模型
│   ├── question_model.dart  # 质检问题模型
│   ├── answer_model.dart    # 答案模型
│   └── ...
├── pages/                    # 主要页面
│   ├── work_list.dart       # 工作任务列表
│   ├── review_list.dart     # 质检任务列表
│   ├── management_page.dart # 用户管理页面
│   ├── work_manager.dart    # 任务管理页面
│   ├── system_set.dart      # 系统设置页面
│   └── ...
├── navi/                     # 导航组件
│   └── app_navigation_drawer.dart
├── main.dart                 # 应用程序入口
├── home_page.dart           # 主页面
└── user_session.dart        # 用户会话管理
```

### 数据模型设计

#### 核心模型类

1. **User** - 用户模型
   - 用户基本信息（ID、姓名、邮箱）
   - 角色权限信息
   - 账户状态管理

2. **WorkModel** - 工作任务模型
   - 任务基本信息
   - 任务状态和进度
   - 分配关系（管理员-工作人员）

3. **ImageModel** - 图像数据模型
   - 图像文件信息
   - 分类和标签
   - 质检状态和结果

4. **QuestionModel** - 质检问题模型
   - 问题内容和类型
   - 答案选项
   - 正确答案标识

## 安装部署

### 环境要求

- **Flutter SDK**: 3.8.1 或更高版本
- **Dart SDK**: 3.0.0 或更高版本
- **操作系统**: Windows 10/11 (主要支持)
- **开发工具**: VS Code

### 安装步骤

1. **克隆项目**
   ```bash
   git clone https://github.com/CurelWintrer/qa_imageprocess
   cd qa_imageprocess
   ```

2. **安装依赖**
   ```bash
   flutter pub get
   ```

3. **配置环境**
   - 修改 `lib/user_session.dart` 中的服务器地址
   - 配置必要的API密钥和服务端点

4. **运行应用**
   ```bash
   # 开发模式
   flutter run -d windows
   
   # 构建发布版本
   flutter build windows
   ```

### 配置说明

#### 服务器配置
在 `user_session.dart` 中配置后端服务器：

```dart
String baseUrl = 'http://your-server:8080';
String apiUrl = 'https://your-ai-api.com/v1/chat/completions';
String apiKey = 'your-api-key';
```

#### 系统设置
应用支持运行时配置以下参数：
- 后端API服务器地址
- AI服务API配置
- 文件存储路径
- 模型选择和参数

## 使用指南

### 管理员操作流程

1. **登录系统** - 使用管理员账户登录
2. **用户管理** - 创建和管理用户账户，分配角色权限
3. **任务创建** - 创建新的图像处理任务
4. **任务分配** - 将任务分配给相应的工作人员
5. **进度监控** - 实时查看任务执行进度和质检结果
6. **系统配置** - 调整系统参数和服务配置

### 普通用户操作流程

1. **登录系统** - 使用分配的账户登录
2. **查看任务** - 查看分配给自己的工作任务
3. **执行质检** - 对图像进行质检，填写质检表单
4. **提交结果** - 提交质检结果，更新任务状态
5. **个人设置** - 管理个人信息和偏好设置



## 故障排除

### 常见问题

1. **登录失败**
   - 检查网络连接
   - 验证服务器地址配置
   - 确认用户凭据正确性
2. **图像加载失败**
   - 检查文件路径和权限
   - 验证图像格式支持
3. **任务状态异常**
   - 检查数据库连接
   - 验证任务流程配置
   - 查看系统日志信息





---

*最后更新时间：2024年12月*